<!-- BEGIN_TF_DOCS -->
# tf_azure

<!-- markdownlint-disable no-inline-html -->
<img src="https://www.datocms-assets.com/2885/1620155113-brandhcterraformprimaryattributedcolor.svg" alt="Terraform logo" height="50" />
&nbsp;&nbsp;&nbsp;&nbsp;
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a8/Microsoft_Azure_Logo.svg/1024px-Microsoft_Azure_Logo.svg.png" alt="Azure logo" height="50">

![Terraform Version](https://img.shields.io/badge/Terraform-%3E=1.5.0-7B42BC)
![AzureRM Version](https://img.shields.io/badge/terraform--provider--azurerm-~%3E_3.57-008AD7)

[Terraform](https://www.terraform.io/) is a tool for building, changing, and versioning
infrastructure safely and efficiently. This repo is used in conjunction
with Terraform's [Azure Provider](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)
and the [tf_terragrunt](https://bitbucket.parsons.com/projects/CM/repos/tf_terragrunt) repo.

This repo contains reusable Terraform modules, while the Terragrunt repo contains
the variables used to define the resources deployed to the different environments.

Please see the following for more info, including install instructions and complete documentation:

* [Terraform/Terragrunt Usage at Parsons](https://confluence.parsons.com/display/IT/Terragrunt)
* [Terraform Website](https://www.terraform.io)
* [Terraform Documentation](https://www.terraform.io/docs/)
* [Terraform Tutorials](https://learn.hashicorp.com/terraform)
* [Azure Provider Documentation](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs)

## Development Workflow

See
[tf_terragrunt](https://bitbucket.parsons.com/projects/CM/repos/tf_terragrunt/browse)
for more info.

1) Clone the repo to `C:\dev\code\cm\tf_azure`
1) Checkout `main` and `git pull` to make sure it's up to date
1) Create a new branch named after your Jira story number, e.g., `git checkout -b STAR-1234`
1) Commit changes and push your branch
1) Open a PR, ensure builds succeed
1) Merge once approved

## Documentation & Examples

This repo uses [terraform-docs](https://terraform-docs.io/) to help with documentation
generation for every module. The config file, `.terraform-docs.yaml`, specifies the
format of the generated README. This tool also forces documentation to be created for
each module. It runs automatically against every PR by the `Jenkinsfile` and will add a
commit to the PR with any changes. Each module's variables (inputs), outputs, and
resources are automatically added to the README in tabular format.

Every module, including the root module, should contain a
`docs` folder, which must contain `description.md` and `examples.txt`. The file
`description.md` should at least contain a H1 heading with the module name and a brief
description of the module. Since we use Bitbucket, make sure you follow their
[Markdown syntax guide](https://confluence.atlassian.com/bitbucketserver/markdown-syntax-guide-776639995.html).
`examples.txt` should contain at least 1 example of a root
module variable value which would be passed to the module. Since these modules are not
standalone and are only used in this repo by the root module, the only examples
provided help you learn how to use the module in the context of this repo.

> NOTE: Do not edit any `README.md` file manually or your changes will get overwritten!

## Linting, Formatting, & Best Practices

This repo uses [tflint](https://github.com/terraform-linters/tflint) and the plugin
[tflint-ruleset-azurerm](https://github.com/terraform-linters/tflint-ruleset-azurerm) to
find possible errors, warn about deprecated syntax and unused declarations, and enforce
best practices. The `Jenkinsfile` in the root of this repo runs automatically against
every PR and will cause the PR's build to fail if there are any findings. Formatting is
handled by the Terraform CLI and any changes will be committed and pushed to the PR's
dev branch. We attempt to follow the best practices outlined in Google's
[Best practices for using Terraform](https://cloud.google.com/docs/terraform/best-practices-for-terraform).

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_app_registrations"></a> [app\_registrations](#input\_app\_registrations) | A collection of app registrations to create in Azure AD | <pre>map(object({<br>    api_permissions = optional(map(list(string)), {})<br>    certificates = optional(map(object({<br>      encoding          = optional(string, "pem")<br>      end_date          = optional(string)<br>      end_date_relative = optional(string)<br>      type              = string<br>      value             = string<br>    })), {})<br>    secrets = optional(map(object({<br>      auto_rotate_days  = optional(number)<br>      end_date_relative = optional(string)<br>      staggered_rotation = optional(object({<br>        overlap_days = optional(number, 10)<br>        rotate_days  = number<br>      }))<br>      vault = optional(object({<br>        mount = string<br>        path  = string<br>      }))<br>    })), {})<br>    web = optional(object({<br>      homepage_url = optional(string)<br>      implicit_grant = optional(object({<br>        access_token_issuance_enabled = optional(bool, false)<br>        id_token_issuance_enabled     = optional(bool, false)<br>      }))<br>      logout_url    = optional(string)<br>      redirect_uris = optional(list(string))<br>    }))<br>  }))</pre> | `{}` | no |
| <a name="input_availability_sets"></a> [availability\_sets](#input\_availability\_sets) | Object map of Azure Availability Sets | <pre>map(object({<br>    location                     = string<br>    managed                      = optional(bool)<br>    platform_fault_domain_count  = optional(string)<br>    platform_update_domain_count = optional(string)<br>    resource_group_name          = string<br>    tags                         = optional(map(string))<br>  }))</pre> | `{}` | no |
| <a name="input_azure_roles"></a> [azure\_roles](#input\_azure\_roles) | A map of custom roles to be created. If `scope` is left blank, it's set to the current<br>subscription. | <pre>map(object({<br>    actions          = list(string)<br>    data_actions     = list(string)<br>    not_actions      = list(string)<br>    not_data_actions = list(string)<br>    role_description = string<br>    scope            = optional(string)<br>  }))</pre> | `{}` | no |
| <a name="input_centralized_private_endpoints"></a> [centralized\_private\_endpoints](#input\_centralized\_private\_endpoints) | A collection of private endpoints to create in the corporate network subscription.<br>This should only be used for internal, corporate resources that don't have a VNet in<br>their subscription. | <pre>map(object({<br>    location          = string<br>    resource_id       = string<br>    subresource_names = list(string)<br>    tags              = optional(map(string))<br>  }))</pre> | `{}` | no |
| <a name="input_consumption_budgets"></a> [consumption\_budgets](#input\_consumption\_budgets) | map of consumption budget objects | <pre>map(object({<br>    amount = number<br>    dimensions = optional(map(object({<br>      name     = string<br>      operator = optional(string)<br>      values   = list(string)<br>    })))<br>    end_date              = optional(string)<br>    management_group_name = optional(string)<br>    notifications = map(object({<br>      contact_emails = optional(list(string))<br>      contact_groups = optional(list(string))<br>      contact_roles  = optional(list(string))<br>      enabled        = optional(bool)<br>      operator       = string<br>      threshold      = number<br>      threshold_type = optional(string)<br>    }))<br>    resource_group_name = optional(string)<br>    start_date          = string<br>    tags = optional(map(object({<br>      name     = string<br>      operator = optional(string)<br>      values   = list(string)<br>    })))<br>    time_grain = optional(string)<br>    type       = string<br>  }))</pre> | `{}` | no |
| <a name="input_corp_dns_subscription_id"></a> [corp\_dns\_subscription\_id](#input\_corp\_dns\_subscription\_id) | Subscription ID of the DNS hub | `string` | n/a | yes |
| <a name="input_corp_network_subscription_id"></a> [corp\_network\_subscription\_id](#input\_corp\_network\_subscription\_id) | Subscription Id of the Virtual Hub | `string` | n/a | yes |
| <a name="input_custom_policies"></a> [custom\_policies](#input\_custom\_policies) | Map of nested values for Custom Policy/Initiative implementations | <pre>map(object({<br>    initiative_definition_name = string<br>    policy_assignments = map(object({<br>      enforce         = bool<br>      initiative_name = string<br>      scope           = string<br>      scope_id        = string<br>    }))<br>    policy_exemptions = optional(map(object({<br>      assignment_name = string<br>      category        = string<br>      scope           = string<br>      scope_id        = string<br>    })), {})<br>  }))</pre> | `{}` | no |
| <a name="input_custom_policy_definitions"></a> [custom\_policy\_definitions](#input\_custom\_policy\_definitions) | Map defining a custom policy definition | <pre>map(object({<br>    description         = string<br>    display_name        = string<br>    metadata            = optional(map(any))<br>    mode                = string<br>    management_group_id = optional(string)<br>    parameters = optional(map(object({<br>      type = string<br>      metadata = optional(object({<br>        description       = optional(string)<br>        displayName       = optional(string)<br>        strongType        = optional(string)<br>        assignPermissions = optional(bool)<br>      }))<br>      allowedValues = optional(list(string))<br>      defaultValue  = optional(string)<br>    })))<br>    policy_rule = string<br>  }))</pre> | `{}` | no |
| <a name="input_data_factories"></a> [data\_factories](#input\_data\_factories) | A collection of data factories to deploy | <pre>map(object({<br>    location               = string<br>    public_network_enabled = optional(bool, false)<br>    resource_group_name    = string<br>    tags                   = optional(map(string))<br>  }))</pre> | `{}` | no |
| <a name="input_default_tags"></a> [default\_tags](#input\_default\_tags) | Required default tags which can be overriden | <pre>object({<br>    App         = string<br>    Environment = string<br>    GBU         = string<br>    JobWbs      = string<br>    Notes       = optional(string)<br>    Owner       = string<br>  })</pre> | n/a | yes |
| <a name="input_deploy_network_watcher"></a> [deploy\_network\_watcher](#input\_deploy\_network\_watcher) | If True, this will deploy a Network Watcher Resource Group and network watcher resources in the following regions:<br>Commercial - eastus2 and westus2<br>Government - usgovvirginia | `bool` | `false` | no |
| <a name="input_dns_hub_custom_forwarding_rulesets"></a> [dns\_hub\_custom\_forwarding\_rulesets](#input\_dns\_hub\_custom\_forwarding\_rulesets) | A collection of DNS forwarding rulesets to create in the DNS hub. This should only be<br>used if a DMZ VNet needs to conditionally forward requests to their own internal DNS<br>server. The key is the domain name (without a period at the end). Each target DNS<br>server should be in the format "IP:port". | <pre>map(object({<br>    location            = string<br>    resource_group_name = optional(string, "rg-dns-prod-01")<br>    rules = map(object({<br>      enabled            = optional(bool, true)<br>      target_dns_servers = set(string)<br>    }))<br>    tags      = optional(map(string))<br>    vnet_keys = list(string)<br>  }))</pre> | `{}` | no |
| <a name="input_dns_hub_forwarding_rulesets"></a> [dns\_hub\_forwarding\_rulesets](#input\_dns\_hub\_forwarding\_rulesets) | A collection of DNS hub forwarding rulesets to create. This should only be used to<br>create centralized DNS hub rulesets that the DMZ VNets will all be linked to. The<br>inbound endpoint IP and outbound endpoint ID will be grabbed from the outputs of the<br>provided `private_resolver_key`. The private DNS zones will be pulled from the outputs<br>of the `azure_dns_hub_private_link_dns_zones` module to be used for creating rules.<br>`custom_rules` should only be used if you need to force resolution of a resource's<br>public endpoint. The key is the domain name (without a period at the end). Each target<br>DNS server should be in the format "IP:port". | <pre>map(object({<br>    custom_rules = optional(map(object({<br>      enabled            = optional(bool, true)<br>      target_dns_servers = set(string)<br>    })), {})<br>    location             = string<br>    private_resolver_key = string<br>    resource_group_name  = string<br>    tags                 = optional(map(string))<br>  }))</pre> | `{}` | no |
| <a name="input_dns_hub_private_link_dns_zones"></a> [dns\_hub\_private\_link\_dns\_zones](#input\_dns\_hub\_private\_link\_dns\_zones) | Map value of Private DNS Zone info | <pre>object({<br>    resource_group_name = string<br>    tags                = optional(map(string))<br>    vnet_keys           = optional(list(string), [])<br>  })</pre> | `null` | no |
| <a name="input_environment"></a> [environment](#input\_environment) | The cloud env which should be used. Used to set cloud to usgovernment | `string` | `null` | no |
| <a name="input_eventhub_namespaces"></a> [eventhub\_namespaces](#input\_eventhub\_namespaces) | Map of objects for Eventhubs | <pre>map(object({<br>    auto_inflate_enabled = bool<br>    capacity             = number<br>    eventhubs = map(object({<br>      message_retention = number<br>      partition_count   = number<br>    }))<br>    location                      = string<br>    maximum_throughput_units      = number<br>    public_network_access_enabled = optional(bool, false)<br>    resource_group_name           = string<br>    sku                           = string<br>    tags                          = optional(map(string))<br>  }))</pre> | `{}` | no |
| <a name="input_key_vaults"></a> [key\_vaults](#input\_key\_vaults) | Map of objects for azure key vaults | <pre>map(object({<br>    enable_rbac_authorization       = optional(bool, true)<br>    enabled_for_disk_encryption     = optional(bool)<br>    enabled_for_template_deployment = optional(bool)<br>    location                        = string<br>    private_endpoints = optional(map(object({<br>      subnet = object({<br>        name                 = string<br>        resource_group_name  = string<br>        virtual_network_name = string<br>      })<br>    })), {})<br>    public_network_access_enabled = optional(bool, false)<br>    purge_protection_enabled      = optional(bool)<br>    resource_group_name           = string<br>    sku                           = optional(string, "standard")<br>    soft_delete_retention_days    = optional(number, 90)<br>    tags                          = optional(map(string))<br>  }))</pre> | `{}` | no |
| <a name="input_load_balancers"></a> [load\_balancers](#input\_load\_balancers) | Map of nested values for load balancers | <pre>map(object({<br>    backend_pool_addresses = map(object({<br>      backend_ip_address        = string<br>      backend_pool_address_name = string<br>    }))<br>    backend_pool_name    = string<br>    frontend_name        = string<br>    frontend_subnet      = string<br>    internal_or_external = string<br>    load_balancer_rules = map(object({<br>      backend_port          = number<br>      disable_outbound_snat = bool<br>      enable_floating_ip    = bool<br>      enable_tcp_reset      = bool<br>      frontend_port         = number<br>      idle_timeout          = number<br>      load_distribution     = string<br>      probe_interval        = number<br>      probe_name            = string<br>      probe_number          = number<br>      probe_port            = number<br>      probe_protocol        = string<br>      probe_request_path    = string<br>      protocol              = string<br>    }))<br>    location             = string<br>    public_ip_name       = string<br>    resource_group_name  = string<br>    sku                  = string<br>    tags                 = optional(map(string))<br>    virtual_network_name = string<br>    zones                = optional(list(string))<br>  }))</pre> | `{}` | no |
| <a name="input_log_analytics_workspaces"></a> [log\_analytics\_workspaces](#input\_log\_analytics\_workspaces) | Map of objects for Log Analytics Workspaces | <pre>map(object({<br>    daily_quota_gb             = optional(number, -1)<br>    internet_ingestion_enabled = optional(bool, true)<br>    internet_query_enabled     = optional(bool, true)<br>    location                   = string<br>    resource_group_name        = string<br>    retention_in_days          = number<br>    sku                        = string<br>    tags                       = optional(map(string))<br>  }))</pre> | `{}` | no |
| <a name="input_managed_identities"></a> [managed\_identities](#input\_managed\_identities) | A collection of user-assigned managed identities to create | <pre>map(object({<br>    location            = string<br>    resource_group_name = string<br>    tags                = optional(map(string))<br>  }))</pre> | `{}` | no |
| <a name="input_management_group_name"></a> [management\_group\_name](#input\_management\_group\_name) | management group name; used for management group subscription association | `string` | `null` | no |
| <a name="input_management_groups"></a> [management\_groups](#input\_management\_groups) | Map of management groups | `map(any)` | `{}` | no |
| <a name="input_monitor_diagnostic_destinations"></a> [monitor\_diagnostic\_destinations](#input\_monitor\_diagnostic\_destinations) | Destinations used by azurerm\_monitor\_diagnostic\_setting to store activity logs in a<br>central location. The log analytics workspace doesn't have to be in the same region as<br>the resource. The eventhub does have to be in the same region as the resource, so they<br>are stored in a map where the key is the region.<br><br>The only time this shouldn't be used is when running a Terragrunt module that manages<br>the logging destinations. | <pre>object({<br>    eventhubs = map(object({ # key = region<br>      authorization_rule_id = string<br>      eventhub_name         = string<br>      namespace_name        = string<br>    }))<br>    log_analytics_workspace_id = string<br>    resource_group_name        = string<br>    subscription_id            = string<br>  })</pre> | `null` | no |
| <a name="input_monitor_diagnostic_settings"></a> [monitor\_diagnostic\_settings](#input\_monitor\_diagnostic\_settings) | Map of objects for Monitor Diagnostic Settings | <pre>map(object({<br>    activitylogs_eventhubs = map(object({<br>      eventhub_name                     = string<br>      eventhubspace_name                = string<br>      eventhubspace_resource_group_name = string<br>      eventhubspace_subscription_id     = string<br>    }))<br>    activitylogs_log_analytics = map(object({<br>      log_analytics_resource_group_name = string<br>      log_analytics_subscription_id     = string<br>      log_analytics_workspace_id        = string<br>    }))<br>  }))</pre> | `{}` | no |
| <a name="input_network_security_groups"></a> [network\_security\_groups](#input\_network\_security\_groups) | Object map of network security rules | <pre>map(object({<br>    flowlogs_enable              = bool<br>    flowlogs_resource_group_name = string<br>    flowlogs_retention_days      = string<br>    flowlogs_storageaccount_id   = string<br>    flowlogs_subscription_id     = string<br>    location                     = string<br>    rules = map(object({<br>      access                     = string<br>      description                = string<br>      destination_address_prefix = string<br>      destination_port_range     = string<br>      direction                  = string<br>      priority                   = number<br>      protocol                   = string<br>      source_address_prefix      = string<br>      source_port_range          = string<br>    }))<br>    resource_group_name = string<br>    tags                = optional(map(string))<br>  }))</pre> | `{}` | no |
| <a name="input_palo_altos"></a> [palo\_altos](#input\_palo\_altos) | Collection of Palo Alto virtual machines | <pre>map(object({<br>    app_insights_settings = optional(map(any), {})<br>    avset_key             = optional(string)<br>    img_version           = string<br>    interfaces = list(object({<br>      create_public_ip     = optional(bool, false)<br>      enable_ip_forwarding = optional(bool, true)<br>      name                 = string<br>      private_ip_address   = optional(string)<br>      subnet_name          = string<br>      vnet_name            = string<br>    }))<br>    location            = string<br>    os_disk_name        = optional(string)<br>    password            = string<br>    public_ip_zones     = optional(list(number))<br>    resource_group_name = string<br>    tags                = optional(map(string))<br>    username            = string<br>    vm_size             = string<br>    vm_zone             = optional(number)<br>  }))</pre> | `{}` | no |
| <a name="input_platform"></a> [platform](#input\_platform) | The current OS, determined by Terragrunt. Some of the returned values can be:<br>darwin, freebsd, linux, windows<br>See: https://terragrunt.gruntwork.io/docs/reference/built-in-functions/#get_platform | `string` | n/a | yes |
| <a name="input_policy_assignments"></a> [policy\_assignments](#input\_policy\_assignments) | Map of nested values for Built-In Policy implementations | <pre>map(object({<br>    built_in_assignments = map(object({<br>      name                   = string<br>      description            = string<br>      enforce                = bool<br>      policy_definition_id   = string<br>      scope                  = string<br>      scope_id               = string<br>      parameters             = optional(string)<br>      metadata               = optional(string)<br>      location               = string<br>      identity_type          = string              # The type of identity to assign (e.g., 'UserAssigned' or 'SystemAssigned')<br>      identity_ids           = optional(list(any)) # List of identity IDs to assign (empty list for 'SystemAssigned')<br>      role_assignment_needed = bool<br>    }))<br>    built_in_exemptions = optional(map(object({<br>      assignment_name = string<br>      category        = string<br>      scope           = string<br>      scope_id        = string<br>    })), {})<br>    role_definition_name = optional(string)<br>  }))</pre> | `{}` | no |
| <a name="input_policy_initiatives"></a> [policy\_initiatives](#input\_policy\_initiatives) | A collection of policy initiatives to create. At least one policy definition must be<br>  added to the initiative, which can be a custom or built-in policy definition. Only<br>  management\_group and subscription assignments are supported. | <pre>map(object({<br>    assignments = optional(map(object({<br>      description = optional(string)<br>      enforce     = optional(bool, true)<br>      identity = optional(object({<br>        managed_identity_keys = optional(list(string), [])<br>        type                  = string<br>      }))<br>      location   = optional(string, "eastus2")<br>      scope_type = string<br>      exemptions = optional(map(object({<br>        category     = string<br>        description  = optional(string)<br>        display_name = string<br>        scope_type   = string<br>      })), {})<br>    })), {})<br>    description                   = optional(string)<br>    display_name                  = string<br>    management_group_display_name = optional(string)<br>    metadata                      = optional(map(any))<br>    parameters                    = optional(map(any))<br>    policy_definition_groups = optional(map(object({<br>      category     = optional(string)<br>      description  = optional(string)<br>      display_name = optional(string)<br>    })), {})<br>    policy_definition_references = map(object({<br>      definition_display_name = optional(string)<br>      parameters = optional(map(object({<br>        list_value   = optional(list(string))<br>        string_value = optional(string)<br>      })), {})<br>      reference_id       = optional(string)<br>      policy_group_names = optional(list(string))<br>    }))<br>  }))</pre> | `{}` | no |
| <a name="input_private_dns_resolvers"></a> [private\_dns\_resolvers](#input\_private\_dns\_resolvers) | A map of DNS resolver configurations. | <pre>map(object({<br>    inbound_subnet_key  = string<br>    location            = string<br>    outbound_subnet_key = string<br>    resource_group_name = string<br>    tags                = optional(map(string))<br>    vnet_key            = string<br>  }))</pre> | `{}` | no |
| <a name="input_recovery_services_vaults"></a> [recovery\_services\_vaults](#input\_recovery\_services\_vaults) | Recovery Services Vaults, each vault contains its own backup policies and backup policies workload | <pre>map(object({<br>    backup_policies = optional(map(object({<br>      backup = object({<br>        frequency = string<br>        time      = string<br>      })<br>      resource_group_name = string<br>      retention_daily = object({<br>        count = number<br>      })<br>      retention_monthly = object({<br>        count    = number<br>        weekdays = list(string)<br>        weeks    = list(string)<br>      })<br>      retention_weekly = object({<br>        count    = number<br>        weekdays = list(string)<br>      })<br>      retention_yearly = object({<br>        count    = number<br>        months   = list(string)<br>        weekdays = list(string)<br>        weeks    = list(string)<br>      })<br>    })), {})<br>    backup_policies_workloads = optional(map(object({<br>      resource_group_name = string<br>      workload_type       = string<br>      settings = object({<br>        compression_enabled = bool<br>        time_zone           = string<br>      })<br>      protection_policies = map(object({<br>        backup = object({<br>          frequency = string<br>          time      = string<br>        })<br>        policy_type = string<br>        retention_daily = object({<br>          count = number<br>        })<br>      }))<br>    })), {})<br>    location                      = string<br>    public_network_access_enabled = optional(bool, false)<br>    resource_group_name           = string<br>    sku                           = string<br>    soft_delete_enabled           = bool<br>    tags                          = optional(map(string))<br>  }))</pre> | `{}` | no |
| <a name="input_resource_groups"></a> [resource\_groups](#input\_resource\_groups) | Resource groups to create. The key is the name and the value is the region | `map(string)` | `{}` | no |
| <a name="input_role_assignments"></a> [role\_assignments](#input\_role\_assignments) | A collection of role assignments to deploy | <pre>map(object({<br>    app_registration_keys = optional(set(string), [])<br>    group_display_names   = optional(set(string), [])<br>    managed_identity_keys = optional(set(string), [])<br>    role_name             = string<br>    scope = object({<br>      display_name = optional(string)<br>      id           = optional(string)<br>      type         = optional(string)<br>    })<br>    user_principal_names = optional(set(string), [])<br>  }))</pre> | `{}` | no |
| <a name="input_route_tables"></a> [route\_tables](#input\_route\_tables) | Map of nested values for custom route tables, routes and assignments to subnets | <pre>map(object({<br>    disable_bgp_route_propagation = optional(bool, false)<br>    location                      = string<br>    resource_group_name           = string<br>    routes = map(object({<br>      address_prefix         = string<br>      next_hop_in_ip_address = optional(string)<br>      next_hop_type          = string<br>    }))<br>    tags = optional(map(string))<br>  }))</pre> | `{}` | no |
| <a name="input_storage_accounts"></a> [storage\_accounts](#input\_storage\_accounts) | Map of objects for Storage Accounts | <pre>map(object({<br>    access_tier                     = optional(string, "Hot")<br>    account_kind                    = optional(string, "StorageV2")<br>    account_replication_type        = string<br>    account_tier                    = string<br>    allow_nested_items_to_be_public = optional(bool, false)<br>    containers = optional(map(object({<br>      container_access_type = optional(string, "private")<br>    })), {})<br>    location = string<br>    network_rules = optional(object({<br>      bypass   = optional(set(string), ["AzureServices"])<br>      ip_rules = list(string)<br>    }))<br>    private_endpoints = optional(map(object({<br>      subnet = object({<br>        name                 = string<br>        resource_group_name  = string<br>        virtual_network_name = string<br>      })<br>      subresource_name = string<br>    })), {})<br>    public_network_access_enabled = optional(bool, false)<br>    resource_group_name           = string<br>    tags                          = optional(map(string))<br>  }))</pre> | `{}` | no |
| <a name="input_subscription_id"></a> [subscription\_id](#input\_subscription\_id) | ID for the Azure subscription | `string` | `null` | no |
| <a name="input_virtual_networks"></a> [virtual\_networks](#input\_virtual\_networks) | Map of nested values for virtual networks and subnets | <pre>map(object({<br>    auto_create_dmz_route_table     = optional(bool, true)<br>    cidr                            = list(string)<br>    dns_servers                     = optional(list(string))<br>    is_dmz                          = optional(bool)<br>    gateway_subnet_address_prefix   = optional(list(string))<br>    link_dns_hub_forwarding_ruleset = optional(bool, false)<br>    location                        = string<br>    private_subnets = map(object({<br>      address_prefixes                              = list(string)<br>      delegation_actions                            = optional(list(string))<br>      delegation_name                               = optional(string)<br>      delegation_service                            = optional(string)<br>      network_security_group_key                    = string<br>      private_endpoint_network_policies_enabled     = optional(bool, false)<br>      private_link_service_network_policies_enabled = optional(bool, false)<br>      route_table_key                               = optional(string)<br>      service_endpoints                             = optional(list(string))<br>    }))<br>    resource_group_name = string<br>    tags                = optional(map(string))<br>  }))</pre> | `{}` | no |
| <a name="input_virtual_wans"></a> [virtual\_wans](#input\_virtual\_wans) | Map of objects for virtual HUBs | <pre>map(object({<br>    allow_branch_to_branch_traffic = bool<br>    disable_vpn_encryption         = bool<br>    location                       = string<br>    resource_group_name            = string<br>    tags                           = optional(map(string))<br>    type                           = string<br>    virtual_hubs = map(object({<br>      instance_0_custom_ip        = list(string)<br>      instance_1_custom_ip        = list(string)<br>      internet_security_enabled   = bool<br>      location                    = string<br>      remote_virtual_network_name = string<br>      routing_preference          = string<br>      scale_unit                  = number<br>      virtual_hub_address_prefix  = string<br>      vpn_gateway_name            = string<br>    }))<br>    vpn_sites = map(object({<br>      asn                  = number<br>      connection_link_name = string<br>      device_model         = string<br>      device_vendor        = string<br>      location             = string<br>      peering_address      = string<br>      provider_name        = string<br>      sa_data_size_kb      = number<br>      site_link_ip_address = string<br>      speed_in_mbps        = number<br>      virtual_hub_key      = string<br>      vpn_connection_name  = string<br>    }))<br>  }))</pre> | `{}` | no |
| <a name="input_windows_virtual_machines"></a> [windows\_virtual\_machines](#input\_windows\_virtual\_machines) | Map of objects for Windows Virtual Machines | <pre>map(object({<br>    backup = optional(object({<br>      policy_key = string<br>      rsv_key    = string<br>    }))<br>    disk_size_gb  = number<br>    domain_join   = bool<br>    key_vault_key = string<br>    location      = string<br>    managed_disks = map(object({<br>      create_option        = string<br>      disk_size_gb         = number<br>      lun                  = number<br>      storage_account_type = string<br>      tier                 = string<br>      zone                 = optional(number)<br>    }))<br>    network_interfaces = map(object({<br>      enable_accelerated_networking = bool<br>      enable_ip_forwarding          = bool<br>      private_ip_address_allocation = string<br>      subnet_key                    = string<br>    }))<br>    resource_group_name  = string<br>    size                 = string<br>    sku                  = string<br>    storage_account_type = string<br>    tags                 = optional(map(string))<br>    timezone             = string<br>    virtual_network      = string<br>    zone                 = optional(number)<br>  }))</pre> | `{}` | no |
| <a name="input_windows_vm_build_script"></a> [windows\_vm\_build\_script](#input\_windows\_vm\_build\_script) | Base64 byte string of the build script file | `string` | `null` | no |

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_app_registration_secrets"></a> [app\_registration\_secrets](#output\_app\_registration\_secrets) | A collection of app registrations & their client secrets |
| <a name="output_app_registrations"></a> [app\_registrations](#output\_app\_registrations) | A collection of app registration and their non-sensitive outputs |
| <a name="output_data_factories"></a> [data\_factories](#output\_data\_factories) | A map of the data factories that were deployed & their outputs |
| <a name="output_dns_hub_forwarding_rulesets"></a> [dns\_hub\_forwarding\_rulesets](#output\_dns\_hub\_forwarding\_rulesets) | A map of the DNS hub's centralized forwarding rulesets by region and their outputs.<br>These should be used by all DMZ VNets for centralized DNS. |
| <a name="output_dns_hub_private_link_dns_zones"></a> [dns\_hub\_private\_link\_dns\_zones](#output\_dns\_hub\_private\_link\_dns\_zones) | The outputs of the module azure\_dns\_hub\_private\_link\_dns\_zones |
| <a name="output_initial_windows_vm_admin_passwords"></a> [initial\_windows\_vm\_admin\_passwords](#output\_initial\_windows\_vm\_admin\_passwords) | The initial admin password for each Windows VM. The password Will be changed by<br>  BeyondTrust immediately upon AD join. The value of this output is a map where the<br>  key is the VM name and the value is the password. |
| <a name="output_managed_identities"></a> [managed\_identities](#output\_managed\_identities) | A map of the user-assigned managed identities that were created & their outputs |
| <a name="output_monitor_diagnostic_destinations"></a> [monitor\_diagnostic\_destinations](#output\_monitor\_diagnostic\_destinations) | Central logging destinations that are used by other Terragrunt modules to configure<br>monitor diagnostic settings. The log analytics workspace doesn't have to be in the<br>same region as the resource being logged. The eventhub namespace does need to be in<br>the same region as the resource being logged. |
| <a name="output_palo_altos"></a> [palo\_altos](#output\_palo\_altos) | A map of the Palo Altos that were deployed |
| <a name="output_storage_accounts"></a> [storage\_accounts](#output\_storage\_accounts) | A map of the storage accounts that were deployed & their outputs |
| <a name="output_windows_vms"></a> [windows\_vms](#output\_windows\_vms) | A map of Windows VMs and their non-sensitive outputs |

## Resources

No resources.

## Examples

```hcl
# N/A
```
<!-- END_TF_DOCS -->